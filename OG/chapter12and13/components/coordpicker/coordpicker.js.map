{"version":3,"file":"coordpicker.js","sources":["src/template.js","src/coordpicker.js"],"sourcesContent":["export default {\n    render(opts) {\n        return `${this.css(opts.useShadowDOM)}\n                ${this.html()}`;\n    },\n\n    mapDOM(scope) {\n        return {\n            thumb: scope.querySelector('.thumb')\n        }\n    },\n\n    html() {\n        return `<div class=\"bg-overlay-a\"></div>\n                <div class=\"bg-overlay-b\"></div>\n                <div class=\"thumb\"></div>`;\n    },\n\n    createHostSelector(useshadow, host) {\n        if (useshadow) {\n            return ':host';\n        } else {\n            return host;\n        }\n    },\n\n    css(useShadowDOM) {\n        const comp = 'wcia-coord-picker';\n        return `<style>\n                    ${this.createHostSelector(useShadowDOM, comp)} {\n                        display: inline-block;\n                        position: relative;\n                    }\n                    \n                    ${this.createHostSelector(useShadowDOM, comp)} .bg-overlay-a {\n                        width: 100%;\n                        height: 100%;\n                        border-radius: var(--border-radius);\n                        position: absolute;\n                        background: linear-gradient(to right, #fff 0%, rgba(255,255,255,0) 100%);\n                    }\n                    \n                    ${this.createHostSelector(useShadowDOM, comp)} .bg-overlay-b {\n                        width: 100%;\n                        height: 100%;\n                        border-radius: var(--border-radius);\n                        position: absolute;\n                        background: linear-gradient(to bottom, transparent 0%, #000 100%);\n                    }\n                    \n                    ${this.createHostSelector(useShadowDOM, comp)} .thumb {\n                        width: 5px;\n                        height: 5px;\n                        position: absolute;\n                        border-style: solid;\n                        border-width: var(--border-width-thick);\n                        border-color: var(--border-inverted-color);\n                        border-radius: var(--border-radius);\n                        pointer-events: none;\n                        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);\n                    }\n                </style>`;\n    }\n}\n","import Template from './template.js';\n\nexport default class CoordPicker extends HTMLElement {\n    static get USE_SHADOWDOM_WHEN_AVAILABLE() { return true; }\n\n    static get observedAttributes() {\n        return ['x', 'y', 'backgroundcolor'];\n    }\n\n    attributeChangedCallback(name, oldVal, newValue) {\n        if (!this.dom) { return; }\n        switch (name) {\n            case 'x':\n            case 'y':\n                this.refreshCoordinates();\n                break;\n\n            case 'backgroundcolor':\n                this.style.backgroundColor = newValue;\n                break;\n        }\n    }\n\n    set x(val) {\n        this.setAttribute('x', val);\n    }\n\n    get x() {\n        return this.getAttribute('x');\n    }\n\n    set y(val) {\n        this.setAttribute('y', val);\n    }\n\n    get y() {\n        return this.getAttribute('y');\n    }\n\n    set backgroundcolor(val) {\n        this.setAttribute('backgroundcolor', val);\n    }\n\n    get backgroundcolor() {\n        return this.getAttribute('backgroundcolor');\n    }\n\n    constructor() {\n        super();\n\n        if (CoordPicker.USE_SHADOWDOM_WHEN_AVAILABLE && this.attachShadow) {\n            this.root = this.attachShadow({mode: 'open'});\n        } else {\n            this.root = this;\n        }\n\n        document.addEventListener('mousemove', e => this.eventHandler(e));\n        document.addEventListener('mouseup', e => this.eventHandler(e));\n        this.addEventListener('mousedown', e => this.eventHandler(e));\n    }\n\n    connectedCallback() {\n        if (!this.initialized) {\n            this.root.innerHTML = Template.render( { useShadowDOM: CoordPicker.USE_SHADOWDOM_WHEN_AVAILABLE && this.attachShadow });\n            this.dom = Template.mapDOM(this.root);\n            if ( typeof cssVars !== 'undefined') {\n                cssVars();\n            }\n            this.initialized = true;\n\n            if (this.x || this.y) {\n                this.refreshCoordinates();\n            }\n\n            if (this.backgroundColor) {\n                this.style.backgroundColor = this.backgroundColor;\n            }\n        }\n    }\n\n    eventHandler(e) {\n        const bounds = this.getBoundingClientRect();\n        const coords = {\n            x: e.clientX - bounds.left,\n            y: e.clientY - bounds.top\n        };\n        switch (e.type) {\n            case 'mousedown':\n                this.isDragging = true;\n                this.updateXY(coords.x, coords.y);\n                this.refreshCoordinates();\n                break;\n\n            case 'mouseup':\n                this.isDragging = false;\n                break;\n\n            case 'mousemove':\n                if (this.isDragging) {\n                    this.updateXY(coords.x, coords.y);\n                    this.refreshCoordinates();\n                }\n                break;\n        }\n    }\n\n    updateXY(x, y) {\n        let hPos = x - this.dom.thumb.offsetWidth/2;\n        let vPos = y - this.dom.thumb.offsetHeight/2;\n        if (hPos > this.offsetWidth) {\n            hPos = this.offsetWidth;\n        }\n        if (hPos < 0) {\n            hPos = 0;\n        }\n        if (vPos > this.offsetHeight) {\n            vPos = this.offsetHeight;\n        }\n        if (vPos < 0) {\n            vPos = 0;\n        }\n        this.x = (hPos / this.offsetWidth) * 100;\n        this.y = (vPos / this.offsetHeight) * 100;\n    }\n\n    refreshCoordinates() {\n        this.dom.thumb.style.left = (this.x/100 * this.offsetWidth - this.dom.thumb.offsetWidth/2) + 'px';\n        this.dom.thumb.style.top = (this.y/100 * this.offsetHeight - this.dom.thumb.offsetWidth/2) + 'px';\n    }\n}\n\nif (!customElements.get('wcia-coord-picker')) {\n    customElements.define('wcia-coord-picker', CoordPicker);\n}\n"],"names":[],"mappings":"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"}